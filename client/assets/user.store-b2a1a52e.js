import{O as d,s as F,U as r,T as m,W as R,X as A,Y as P,K as j,Z as M,D as a,P as Y,i as g,j as u,$ as J,S as z,x as y,L as K,C as v,k as T,z as Q,y as W,A as X}from"./index-6bbaaed9.js";import{N as Z}from"./na.store-4a612637.js";import{B as $}from"./bart.service-94933cd4.js";import{C as q}from"./cso.store-fb12af7b.js";import{P as H}from"./po.store-ced8ebcb.js";class ee{getAllUsers(){return console.log("getAllUsers()"),d.users}async getUserById(t){console.log("getUserById()",t);{const n=d.users.find(i=>i.user_id===t);if(n)return n}return null}async createUser(t){return console.log("createUser()",t),t.user_id=F.string.uuid(),t}async updateUser(t,n){return console.log("id",t),console.log("updateUser()",n),n}getAge(t){const n=new Date;let i=n.getFullYear()-t.getFullYear();const o=n.getMonth()-t.getMonth();return(o<0||o===0&&n.getDate()<t.getDate())&&i--,i}getSubType(t,n){if(t===r.ACDV_BART){const i=d.barts.find(o=>o.id===n);return i?i.name:(console.error("bart not found"),"")}if(t===r.ACDV_CSO){const i=d.csos.find(o=>o.id===n);return i?i.name:(console.error("cso not found"),"")}if(t===r.ACDV_PO){const i=d.pos.find(o=>o.id===n);return i?i.name:(console.error("po not found"),"")}if(t===r.National_Agency){const i=d.nas.find(o=>o.id===n);return i?i.name:(console.error("na not found"),"")}return m[t]}}const p=new ee,S=c=>{const t=[];for(let n in c)t.push({id:c[n].id,text:c[n].text,selected:!1});return t[0].selected=!0,t},U={user_id:"",last_name:"",first_name:"",gender:R.Male,address:"",birth_date:new Date,contact_no:"",blood_type:A[0],status:P.Active,dispatch_status:j.Queue,user_name:"",password:"",user_level:M.Field_Operator,type:r.LGU_Casual,sub_type_id:r.LGU_Casual.toString(),distinctType:a.LGU,personnelSkills:[]},te=Z.getAllNAs(),se=q.getAllCSOs(),re=H.getAllPOs(),ne=$.getAllBARTs(),ce=Y("user",()=>{const c=g([]),t=g({...U}),n=e=>{c.value=e},i=u(()=>c.value.map(e=>(e.age=p.getAge(e.birth_date),e.userLevelText=J[e.user_level],e.typeText=z[e.type],e.statusObj=y[e.status],e.dispatchStatusObj=K[e.dispatch_status],e.genderObj=v[e.gender],e.type===r.ACDV_BART||e.type===r.ACDV_CSO||e.type===r.ACDV_INDIVIDUAL||e.type===r.ACDV_PO?(e.subTypeText=m[e.type],e.sub_type_id&&(e.subSubTypeText=p.getSubType(e.type,e.sub_type_id))):e.sub_type_id&&(e.subTypeText=p.getSubType(e.type,e.sub_type_id)),e))),o=u(()=>S(v)),C=u(()=>S(y)),D=u(()=>S(Q)),b=u(()=>S(W)),k=u(()=>A),O=u(()=>{const e=S(X);return t.value.distinctType===a.LGU?e.filter(s=>s.id>10&&s.id<20):t.value.distinctType===a.ACDV?e.filter(s=>s.id>20&&s.id<30):t.value.distinctType===a.National_Agency?e.filter(s=>s.id>30&&s.id<40):[]}),L=u(()=>{if(!t.value.type)return null;if(t.value.distinctType===a.LGU)return[];if(t.value.distinctType===a.National_Agency)return te;if(t.value.distinctType===a.ACDV){if(t.value.type===r.ACDV_CSO)return se;if(t.value.type===r.ACDV_PO)return re;if(t.value.type===r.ACDV_BART)return ne;if(t.value.type===r.ACDV_INDIVIDUAL)return[]}return[]}),N=u(()=>t.value.type),x=u(()=>t.value.distinctType);T(x,e=>{e&&(e===a.LGU?t.value.type=r.LGU_Regular:e===a.ACDV?t.value.type=r.ACDV_CSO:e===a.National_Agency&&(t.value.type=r.National_Agency))}),T(N,e=>{e&&(t.value.sub_type_id="",t.value.distinctType===a.LGU&&(console.log("watching formDataType..."),e===r.LGU_Casual?t.value.sub_type_id=r.LGU_Casual.toString():e===r.LGU_Job_Order?t.value.sub_type_id=r.LGU_Job_Order.toString():e===r.LGU_Regular&&(t.value.sub_type_id=r.LGU_Regular.toString())))});const V=()=>p.getAllUsers(),G=e=>{console.log("addSkillInFormData()",e),t.value.personnelSkills||(t.value.personnelSkills=[]),t.value.personnelSkills.push(e)},h=e=>{var l;if(!t.value.personnelSkills)return;console.log("removeSkillInFormData()",e);const s=(l=t.value.personnelSkills)==null?void 0:l.findIndex(_=>_.training_id===e);if(s===-1){console.error("training_id not found in formData.personnelSkills");return}t.value.personnelSkills.splice(s,1)},I=(e,s)=>{if(!t.value.personnelSkills)return;console.log("addCertificateInSkill()",e,s);const l=t.value.personnelSkills.find(f=>f.training_id===e);if(!l){console.error("skill not found in personelSkills");return}if(l.certificates||(l.certificates=[]),l.certificates.find(f=>f===s)){console.error("certificate already exist");return}l.certificates.push(s)},w=(e,s)=>{if(!t.value.personnelSkills)return;console.log("delCertificateInSkill()",e,s);const l=t.value.personnelSkills.find(f=>f.training_id===e);if(!l){console.error("skill not found in personelSkills");return}if(!l.certificates){console.error("skill.certificates is undefined");return}const _=l.certificates.findIndex(f=>f===s);if(_===-1){console.error("certificate not found in skill.certificates");return}l.certificates.splice(_,1)},B=async e=>{if(console.log("saveUser()",e),e.birth_date=new Date(e.birth_date),e.user_id.trim()!==""){console.log("update");const l=await p.updateUser(e.user_id,e);return console.log("updatedUser ",l),l}const s=await p.createUser(e);return console.log("createdUser",s),c.value.unshift(s),E(),s},E=()=>{t.value={...U}};return{users:i,formData:t,genders:o,status:C,bloodTypes:k,userLevels:b,userTypes:D,userSubTypes:O,userSubSubTypes:L,setUsers:n,getUsers:V,addSkillInFormData:G,removeSkillInFormData:h,addCertificateInSkill:I,delCertificateInSkill:w,saveUser:B}});export{p as a,ce as u};
